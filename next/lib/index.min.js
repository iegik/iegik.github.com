"use strict";(()=>{var d="ae0dcffd947e0ca15a12";var s="Page not found",m="Wrong request";var f=()=>{let{protocol:o,hash:e,pathname:t}=document.location;return`${t.replace("index.html","")}${e.slice(2)}`};var ce="\u{1F34F},\u{1F330},\u{1F34B},\u{1F345},\u{1F346},\u{1F347},\u{1F353},\u{1F349},\u{1F350},\u{1F352},\u{1F351},\u{1F951}".split(","),{floor:le,random:fe}=Math;var a=(o=void 0)=>typeof history>"u"?[]:[o||history.state||{},(e,t,r)=>history.pushState({...history.state,...e},t||"",r||location.href)];var $=!1;var c=$?()=>{}:(...o)=>{console.debug(...o)};var l=$?()=>{}:(...o)=>{console.info(...o)};var C=async o=>{if(!o)return;c("Requesting access_token",{code:o,clientId:d});let{access_token:e,scope:t,token_type:r}=await fetch(`https://qilg4ch66b3vpgtevzccb5meum0ttfcl.lambda-url.eu-north-1.on.aws/?code=${o}&client_id=${d}`).then(n=>n.json());window.sessionStorage?.setItem("access_token",e),window.sessionStorage?.setItem("scope",t),window.sessionStorage?.setItem("token_type",r),document.location.href="/#/profile"},N=async o=>{if(typeof document>"u")return;let{protocol:e,hash:t,search:r}=document.location,n=window.sessionStorage?.getItem("state"),i=window.sessionStorage?.getItem("code");c("Checking GET params",{protocol:e,hash:t,search:r,state:n});let v=new URLSearchParams(r);if(v.get("state")!==n)return window.history?.go(-2);C(v.get("code")||void 0)},y=N;var R=`query RepoFile($repo_owner: String!, $repo_name: String!, $object_path: String!) {
  repository(owner: $repo_owner, name: $repo_name) {
    object(expression: $object_path) {
      ... on Blob {
        byteSize
        text
      }
    }
  }
}
# {
#   "repo_name": "iegik.github.com",
#   "repo_owner": "iegik",
#   "object_path": "gh-pages: data/home.json"
# }`;var b=`query GetUser($login:String!) {
  user(login: $login) {
    avatarUrl
    login
  }
}
`;var F=async o=>{let{data:e,errors:t}=await o.json();if(t)throw t[0];return e},h=class o{constructor(){this.repoName="iegik.github.com";this.repoOwner="iegik";this.storeRoot="gh-pages:data"}static{this.instance=new o}static getInstance(){return this.instance}async request({query:e,variables:t}){if(typeof window>"u")return;let r=window.sessionStorage?.getItem("access_token"),n=window.sessionStorage?.getItem("token_type"),i=await fetch("https://api.github.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`${n} ${r}`},body:JSON.stringify({query:e,variables:t})});return F(i)}async getFile(e){let t=await this.request({query:R,variables:{repo_name:this.repoName,repo_owner:this.repoOwner,object_path:`${this.storeRoot}${e}.json`}});if(!t)throw Error(m);let{repository:{object:r}}=t;if(!r)throw Error(s);let{text:n}=r;return JSON.parse(n)}async getUserInfo(){let{user:e}=await this.request({query:b,variables:{login:this.repoOwner}});if(!e)throw Error(m);return e}},u=h;var U=async o=>{let[{isLoaded:e},t]=a();e||(async()=>{let n=f(),i=await u.getInstance().getFile(n);t({data:i,isLoaded:!0})})()},k=U;var A=o=>o.json(),w=class o{static{this.instance=new o}constructor(){}static getInstance(){return this.instance}async request(e){let t=await fetch(`${location.protocol}//${location.host}/data${e}`,{headers:{"Content-Type":"application/json",Accept:"application/json"}});return A(t)}async getFile(e){let t=await this.request(`${e}.json`);if(!t)throw Error(s);return t}},x=w;var q=async o=>{let[e={},t]=a();l("PreviewService",{state:e,setUserInfo:t});let r=f(),n=await x.getInstance().getFile(r);l(`File ${r} loaded`,{data:n,state:e}),t(n)},S=q;var H=async o=>{let[{variables:e},t]=a();e||(async()=>{let{avatarUrl:n,login:i}=await u.getInstance().getUserInfo();t({children:[{tag:"img",src:n},{tag:"span",children:i}],variables:{avatarUrl:n}})})()},E=H;var B={oauth:y,editor:k,preview:S,userInfo:E},O=B;})();
//# sourceMappingURL=index.min.js.map
